# [tag] 本サイトでの Web 広告の導入と検証

## Intro

本サイトは、様々な Web に関する技術を調査し、実際に試すためにサイト自体に適用しながらそれを記事にまとめるという目的で運用してきた。

様々な技術を試したり、そのパフォーマンスやセキュリティへの影響を評価する上で、なるべく一般的なサイトの構成とかけ離れていれば、あまり意味をなさない。

そのため、本サイトでは以下のように、別に必要はない機能やサービスをあえて導入している。

- AMP 対応(AMP より Origin の方が速いが、評価のために入れている)
- Google Analytics(あまり見ることはないが、多くのサイトに入っているため入れている)
- Web Font(タイポグラフィにこだわりがあるわけではないが、 WebFont も入れずにパフォーマンスを測れば速いのは当たり前なので入れている)
- Youtube(手元に動画ファイルがあるので `<video>` で貼れば良いが、サードパーティー `<iframe>` を埋め込む場合の挙動を見たいので入れいている)
- human.txt(だれが見ることもないと思うが入れている)

こうした、特に必要もないがよく使われている技術やサービスを入れておくことは、例えば以下のような指標を測定する際に、多くの発見がある。

- Performance
  - 日本語 WebFont の影響や、サブセッティングの効果
  - AMP が速いとは限らないこと
- CSP/Feature Policy の reporting
  - 特に Youtube の iframe 対応の面倒さ
  - human.txt が CSP に違反するケース
- etc,etc,etc

しかし、一般的なサービスが行っており、本サイトで行っていなかった大きな差異が一つある。それが **広告の掲載** だ。

本サイトは、収益化を目的としてやってるわけではないし、広告があっても邪魔なだけなので、サイトの設立時から導入するつもりは一切なかった。

ところが、昨今の Web において、 3rd Party Cookie の扱いやトラッキングの議論を考える上で、広告の存在は無視することができなくなっている。

広告を設置してない状態では、広告があることによって起こると予想される様々な事象を見落としてる可能性が考えられるのだ。

- 3rd Party Cookie がブロックされたとき、広告収益には具体的にどの程度の影響があるのか
  - これを正確に比較して知るためには、本来 ITP よりも前に本サイトに広告があれば理想だったが、それは遅いのでしょうがない
- ブラウザに 3rd Party Cookie に対する制限が実装された時、広告のあるサイトでは実際どういう挙動を引き起こすのか
  - 特に Reporting API に Intervention Report が送られてくるのかどうか
  - CSP や Feature Policy に 3rd Party Cookie などに関する directive が増えるのかどうか
- 広告ベンダがそうした制限に対する対策を講じるとしたら、それはどういう形で配信者に提供されるのか
  - アナウンスには、どういう説明が送られてくるのか
  - Privacy Sandbox などはどういう API として提供されるのか
- その他
  - 広告があることによって起こる未知の事象


そこで、本サイトにも広告を導入することを検討した。

プロバイダの選定は以下のように行う。

- 個人でも広告が掲載できる
- やめたい時にすぐやめられる
- 3rd Party Cookie を利用している
- 一般的なサイトでの採用率が高い
- 広告の掲載場所がある程度自分でコントロールできる


特に最後の掲載場所は重要だ。
広告を設置するとはいえ、収益よりもサイトのコンテンツを重要視しているので、広告はページの下部にでも表示できればそれでよい。
逆を言えば、そういう設置場所のコントロールもできないと、採用は難しい。

詳しい人に色々聞きながら、最終的に Google AdSence を導入することにした。
